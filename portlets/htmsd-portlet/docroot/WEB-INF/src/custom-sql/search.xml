<?xml version="1.0" encoding="UTF-8"?>
<custom-sql>
	<sql
		id="com.htmsd.slayer.service.persistence.ShoppingItemFinderImpl.findItemByTagName">
		   <![CDATA[
			    SELECT 
			  		DISTINCT
					si.* 
				FROM 
					AssetEntry ae
				INNER JOIN
					AssetEntries_AssetTags ae_at
				ON
					ae.entryId = ae_at.entryId
                INNER JOIN 
					AssetTag ast
				ON 
					ast.tagId = ae_at.tagId
				INNER JOIN  
					htmsd_ShoppingItem si
				ON 
					si.itemId = ae.classPK
                    AND NOT si.quantity = 0
                    AND si.status = 1
                    OR si.name like ?
                    OR ast.name like ?
   				[$sort]
		 	]]>
	</sql>
</custom-sql>
	